{"ast":null,"code":"import _objectSpread from \"C:/Users/Brandon/Desktop/FIN 6392 G3 P2 Workspace/3x3-monte-dapp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"C:/Users/Brandon/Desktop/FIN 6392 G3 P2 Workspace/3x3-monte-dapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Brandon\\\\Desktop\\\\FIN 6392 G3 P2 Workspace\\\\3x3-monte-dapp\\\\src\\\\components\\\\pages\\\\StartPage.js\",\n    _s = $RefreshSig$();\n\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Brandon\\\\Desktop\\\\FIN 6392 G3 P2 Workspace\\\\3x3-monte-dapp\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport { Header } from \"./start_page_comp/header\";\nimport { Base } from \"../base\";\nimport { handleEthAccReq } from \"../handleEthAccReq\";\nimport { useContext, useState } from \"react\";\nimport { GlobalState } from \"../global_states/global_state\";\nimport { ethers } from \"ethers\";\nimport { useEffect } from \"react\";\nimport { GamePage } from \"../site_stuff/game_page\";\nimport erc20abi from \"../../ERC20abi.json\";\nimport ErrorMessage from \"../../ErrorMessage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function StartPage() {\n  _s();\n\n  var _useContext = useContext(GlobalState),\n      currentUserInfo = _useContext.currentUserInfo,\n      setCurrentUserInfo = _useContext.setCurrentUserInfo,\n      accReqPending = _useContext.accReqPending,\n      setAccReqPending = _useContext.setAccReqPending;\n\n  var contractAddress = currentUserInfo.contractAddress;\n  var provider = currentUserInfo.provider;\n  var signer = currentUserInfo.signer;\n  var signerAddress = currentUserInfo.signerAddress;\n  var erc20 = currentUserInfo.erc20;\n  useEffect(function () {\n    console.log(\"useeffect\");\n    var sessStorage = JSON.parse(sessionStorage.getItem(accReqPending));\n    setAccReqPending(function () {\n      if (accReqPending !== null && sessStorage === null) {\n        return accReqPending;\n      } else if (accReqPending !== sessStorage && sessStorage !== null) {\n        return sessStorage;\n      } else return accReqPending;\n    });\n  }, [accReqPending]);\n\n  var updateUser = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _ethReqP;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n\n              if (window.ethereum) {\n                _context.next = 3;\n                break;\n              }\n\n              throw new Error('No crypto wallet found. Please install \"MetaMask\" in the Chrome Extensions Store');\n\n            case 3:\n              _context.next = 8;\n              break;\n\n            case 5:\n              _context.prev = 5;\n              _context.t0 = _context[\"catch\"](0);\n              alert(_context.t0);\n\n            case 8:\n              provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\n\n              if (accReqPending === null) {\n                setAccReqPending(true);\n              }\n\n              _context.next = 12;\n              return handleEthAccReq();\n\n            case 12:\n              _ethReqP = _context.sent;\n\n              if (_ethReqP) {\n                _context.next = 19;\n                break;\n              }\n\n              console.log(\"ethreqp pending\");\n              sessionStorage.setItem(accReqPending, true);\n              setAccReqPending(true);\n              _context.next = 28;\n              break;\n\n            case 19:\n              erc20 = new ethers.Contract(contractAddress, erc20abi, provider);\n              signer = provider.getSigner();\n              _context.next = 23;\n              return signer.getAddress().catch(function (e) {\n                return console.log(e);\n              });\n\n            case 23:\n              signerAddress = _context.sent;\n              console.log(\"ethreqp not pending\");\n              sessionStorage.setItem(accReqPending, false);\n              setAccReqPending(false);\n              setCurrentUserInfo(function (prev) {\n                return _objectSpread(_objectSpread({}, prev), {}, {\n                  provider: provider,\n                  signer: signer,\n                  signerAddress: signerAddress,\n                  erc20: erc20\n                });\n              });\n\n            case 28:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 5]]);\n    }));\n\n    return function updateUser() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  if (accReqPending) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"rt-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"col-rt-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"Scriptcontent\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"pregame_background\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"box\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: \"Trying to connect...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 78,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Please check your Web3 Chrome extension (i.e. \\\"MetaMask\\\")\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 79,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Once connected, click \\\"Retry\\\"\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 80,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: function onClick() {\n                    return updateUser();\n                  },\n                  children: \"Retry\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 81,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 77,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  } else if (currentUserInfo.signerAddress != \"-\") {\n    return /*#__PURE__*/_jsxDEV(GamePage, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"rt-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"col-rt-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"Scriptcontent\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"pregame_background\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"box\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: \"Click \\\"Connect\\\" to connect to your Web3 Wallet!\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 100,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: function onClick() {\n                    return updateUser();\n                  },\n                  children: \"Connect\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 101,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  }\n}\n\n_s(StartPage, \"8BrYFBFM1l7QA/gemhltwMhVQWA=\");\n\n_c = StartPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"StartPage\");","map":{"version":3,"sources":["C:/Users/Brandon/Desktop/FIN 6392 G3 P2 Workspace/3x3-monte-dapp/src/components/pages/StartPage.js"],"names":["Header","Base","handleEthAccReq","useContext","useState","GlobalState","ethers","useEffect","GamePage","erc20abi","ErrorMessage","StartPage","currentUserInfo","setCurrentUserInfo","accReqPending","setAccReqPending","contractAddress","provider","signer","signerAddress","erc20","console","log","sessStorage","JSON","parse","sessionStorage","getItem","updateUser","window","ethereum","Error","alert","providers","Web3Provider","_ethReqP","setItem","Contract","getSigner","getAddress","catch","e","prev"],"mappings":";;;;;;;AAAA,SAASA,MAAT,QAAuB,0BAAvB;AACA,SAASC,IAAT,QAAqB,SAArB;AACA,SAASC,eAAT,QAAgC,oBAAhC;AACA,SAASC,UAAT,EAAqBC,QAArB,QAAqC,OAArC;AACA,SAASC,WAAT,QAA4B,+BAA5B;AACA,SAASC,MAAT,QAAuB,QAAvB;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,SAASC,QAAT,QAAyB,yBAAzB;AACA,OAAOC,QAAP,MAAqB,qBAArB;AACA,OAAOC,YAAP,MAAyB,oBAAzB;;;AAIA,OAAO,SAASC,SAAT,GAAqB;AAAA;;AACxB,oBAAiFR,UAAU,CAACE,WAAD,CAA3F;AAAA,MAAQO,eAAR,eAAQA,eAAR;AAAA,MAAyBC,kBAAzB,eAAyBA,kBAAzB;AAAA,MAA6CC,aAA7C,eAA6CA,aAA7C;AAAA,MAA4DC,gBAA5D,eAA4DA,gBAA5D;;AACA,MAAMC,eAAe,GAAGJ,eAAe,CAACI,eAAxC;AACA,MAAIC,QAAQ,GAAGL,eAAe,CAACK,QAA/B;AACA,MAAIC,MAAM,GAAGN,eAAe,CAACM,MAA7B;AACA,MAAIC,aAAa,GAAGP,eAAe,CAACO,aAApC;AACA,MAAIC,KAAK,GAAGR,eAAe,CAACQ,KAA5B;AACAb,EAAAA,SAAS,CAAC,YAAM;AACZc,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACA,QAAMC,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,cAAc,CAACC,OAAf,CAAuBb,aAAvB,CAAX,CAApB;AACAC,IAAAA,gBAAgB,CAAC,YAAM;AACnB,UAAID,aAAa,KAAK,IAAlB,IAA0BS,WAAW,KAAK,IAA9C,EAAoD;AAChD,eAAOT,aAAP;AACH,OAFD,MAEO,IAAIA,aAAa,KAAKS,WAAlB,IAAiCA,WAAW,KAAK,IAArD,EAA2D;AAC9D,eAAOA,WAAP;AACH,OAFM,MAEA,OAAOT,aAAP;AACV,KANe,CAAhB;AAOH,GAVQ,EAUP,CAACA,aAAD,CAVO,CAAT;;AAYA,MAAMc,UAAU;AAAA,wEAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,kBAENC,MAAM,CAACC,QAFD;AAAA;AAAA;AAAA;;AAAA,oBAGD,IAAIC,KAAJ,CAAU,kFAAV,CAHC;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAKXC,cAAAA,KAAK,aAAL;;AALW;AAOff,cAAAA,QAAQ,GAAG,IAAIX,MAAM,CAAC2B,SAAP,CAAiBC,YAArB,CAAkCL,MAAM,CAACC,QAAzC,EAAmD,KAAnD,CAAX;;AACA,kBAAIhB,aAAa,KAAK,IAAtB,EAA4B;AACxBC,gBAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACH;;AAVc;AAAA,qBAWQb,eAAe,EAXvB;;AAAA;AAWTiC,cAAAA,QAXS;;AAAA,kBAYVA,QAZU;AAAA;AAAA;AAAA;;AAaXd,cAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAI,cAAAA,cAAc,CAACU,OAAf,CAAuBtB,aAAvB,EAAsC,IAAtC;AACAC,cAAAA,gBAAgB,CAAC,IAAD,CAAhB;AAfW;AAAA;;AAAA;AAiBXK,cAAAA,KAAK,GAAG,IAAId,MAAM,CAAC+B,QAAX,CAAoBrB,eAApB,EAAqCP,QAArC,EAA+CQ,QAA/C,CAAR;AACAC,cAAAA,MAAM,GAAGD,QAAQ,CAACqB,SAAT,EAAT;AAlBW;AAAA,qBAmBWpB,MAAM,CAACqB,UAAP,GAAoBC,KAApB,CAA0B,UAAAC,CAAC;AAAA,uBAAIpB,OAAO,CAACC,GAAR,CAAYmB,CAAZ,CAAJ;AAAA,eAA3B,CAnBX;;AAAA;AAmBXtB,cAAAA,aAnBW;AAoBXE,cAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;AACAI,cAAAA,cAAc,CAACU,OAAf,CAAuBtB,aAAvB,EAAsC,KAAtC;AACAC,cAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACAF,cAAAA,kBAAkB,CAAC,UAAA6B,IAAI,EAAI;AACnB,uDACOA,IADP;AAEIzB,kBAAAA,QAAQ,EAARA,QAFJ;AAGIC,kBAAAA,MAAM,EAANA,MAHJ;AAIIC,kBAAAA,aAAa,EAAbA,aAJJ;AAKIC,kBAAAA,KAAK,EAALA;AALJ;AAOH,eARa,CAAlB;;AAvBW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAVQ,UAAU;AAAA;AAAA;AAAA,KAAhB;;AAoCA,MAAId,aAAJ,EAAmB;AACf,wBACI;AAAA,8BACI,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI;AAAK,QAAA,KAAK,EAAC,cAAX;AAAA,+BACI;AAAK,UAAA,KAAK,EAAC,WAAX;AAAA,iCACI;AAAK,YAAA,KAAK,EAAC,eAAX;AAAA,mCACI;AAAK,cAAA,KAAK,EAAC,oBAAX;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAC,KAAX;AAAA,wCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHJ,eAII;AAAQ,kBAAA,OAAO,EAAE;AAAA,2BAAMc,UAAU,EAAhB;AAAA,mBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cAFJ;AAAA,oBADJ;AAmBH,GApBD,MAoBO,IAAIhB,eAAe,CAACO,aAAhB,IAAiC,GAArC,EAAyC;AAC5C,wBAAQ,QAAC,QAAD;AAAA;AAAA;AAAA;AAAA,YAAR;AACH,GAFM,MAEA;AACH,wBACI;AAAA,8BACI,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI;AAAK,QAAA,KAAK,EAAC,cAAX;AAAA,+BACI;AAAK,UAAA,KAAK,EAAC,WAAX;AAAA,iCACI;AAAK,YAAA,KAAK,EAAC,eAAX;AAAA,mCACI;AAAK,cAAA,KAAK,EAAC,oBAAX;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAC,KAAX;AAAA,wCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAQ,kBAAA,OAAO,EAAE;AAAA,2BAAMS,UAAU,EAAhB;AAAA,mBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cAFJ;AAAA,oBADJ;AAiBH;AAEJ;;GAjGejB,S;;KAAAA,S","sourcesContent":["import { Header } from \"./start_page_comp/header\"\r\nimport { Base } from \"../base\"\r\nimport { handleEthAccReq } from \"../handleEthAccReq\"\r\nimport { useContext, useState } from \"react\"\r\nimport { GlobalState } from \"../global_states/global_state\"\r\nimport { ethers } from \"ethers\"\r\nimport { useEffect } from \"react\"\r\nimport { GamePage } from \"../site_stuff/game_page\"\r\nimport erc20abi from \"../../ERC20abi.json\"\r\nimport ErrorMessage from \"../../ErrorMessage\"\r\n\r\n\r\n\r\nexport function StartPage() {\r\n    const { currentUserInfo, setCurrentUserInfo, accReqPending, setAccReqPending } = useContext(GlobalState);\r\n    const contractAddress = currentUserInfo.contractAddress;\r\n    var provider = currentUserInfo.provider;\r\n    var signer = currentUserInfo.signer;\r\n    var signerAddress = currentUserInfo.signerAddress;\r\n    var erc20 = currentUserInfo.erc20;\r\n    useEffect(() => {\r\n        console.log(\"useeffect\");\r\n        const sessStorage = JSON.parse(sessionStorage.getItem(accReqPending));\r\n        setAccReqPending(() => {\r\n            if (accReqPending !== null && sessStorage === null) {\r\n                return accReqPending;\r\n            } else if (accReqPending !== sessStorage && sessStorage !== null) {\r\n                return sessStorage;\r\n            } else return accReqPending\r\n        })\r\n    },[accReqPending]);\r\n\r\n    const updateUser = async () => {\r\n        try {\r\n            if (!window.ethereum)\r\n                throw new Error('No crypto wallet found. Please install \"MetaMask\" in the Chrome Extensions Store')\r\n        } catch (err) {\r\n            alert(err)\r\n        }\r\n        provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\r\n        if (accReqPending === null) {\r\n            setAccReqPending(true);\r\n        }\r\n        const _ethReqP = await handleEthAccReq();\r\n        if (!_ethReqP) {\r\n            console.log(\"ethreqp pending\");\r\n            sessionStorage.setItem(accReqPending, true);\r\n            setAccReqPending(true);\r\n        } else {\r\n            erc20 = new ethers.Contract(contractAddress, erc20abi, provider);\r\n            signer = provider.getSigner();\r\n            signerAddress = await signer.getAddress().catch(e => console.log(e));\r\n            console.log(\"ethreqp not pending\");\r\n            sessionStorage.setItem(accReqPending, false);\r\n            setAccReqPending(false);\r\n            setCurrentUserInfo(prev => {\r\n                    return {\r\n                        ...prev,\r\n                        provider,\r\n                        signer,\r\n                        signerAddress,\r\n                        erc20\r\n                    }\r\n                });\r\n        }\r\n    \r\n    }\r\n\r\n    if (accReqPending) {\r\n        return (\r\n            <>\r\n                <Header />\r\n                <div class=\"rt-container\">\r\n                    <div class=\"col-rt-12\">\r\n                        <div class=\"Scriptcontent\">\r\n                            <div class=\"pregame_background\">\r\n                                <div class=\"box\">\r\n                                    <h3>Trying to connect...</h3>\r\n                                    <p>Please check your Web3 Chrome extension (i.e. \"MetaMask\")</p>\r\n                                    <p>Once connected, click \"Retry\"</p>\r\n                                    <button onClick={() => updateUser()}>Retry</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </>\r\n        )\r\n    } else if (currentUserInfo.signerAddress != \"-\"){\r\n        return (<GamePage />)\r\n    } else {\r\n        return (\r\n            <>\r\n                <Header />\r\n                <div class=\"rt-container\">\r\n                    <div class=\"col-rt-12\">\r\n                        <div class=\"Scriptcontent\">\r\n                            <div class=\"pregame_background\">\r\n                                <div class=\"box\">\r\n                                    <h3>Click \"Connect\" to connect to your Web3 Wallet!</h3>\r\n                                    <button onClick={() => updateUser()}>Connect</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </>\r\n            )\r\n    }\r\n    \r\n}"]},"metadata":{},"sourceType":"module"}